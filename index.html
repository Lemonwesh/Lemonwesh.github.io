<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lemons Proxy | v4.0 Educational Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --blueprint-bg: #0066CC;
            --blueprint-grid: rgba(255, 255, 255, 0.15);
            --blueprint-line: rgba(255, 255, 255, 0.8);
            --accent: #FF6B35;
            --warning: #FFD700;
        }

        body {
            background-color: var(--blueprint-bg);
            background-image: 
                linear-gradient(var(--blueprint-grid) 1px, transparent 1px),
                linear-gradient(90deg, var(--blueprint-grid) 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Courier Prime', monospace;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .tech-border {
            position: fixed;
            border: 2px solid var(--blueprint-line);
            pointer-events: none;
            z-index: 1000;
        }

        .tech-border.top-left { top: 10px; left: 10px; width: 100px; height: 100px; border-right: none; border-bottom: none; }
        .tech-border.top-right { top: 10px; right: 10px; width: 100px; height: 100px; border-left: none; border-bottom: none; }
        .tech-border.bottom-left { bottom: 10px; left: 10px; width: 100px; height: 100px; border-right: none; border-top: none; }
        .tech-border.bottom-right { bottom: 10px; right: 10px; width: 100px; height: 100px; border-left: none; border-top: none; }

        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 3px double var(--blueprint-line);
            position: relative;
            background: rgba(0, 0, 0, 0.2);
        }

        .blueprint-title {
            font-family: 'Share Tech Mono', monospace;
            font-size: 3rem;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            position: relative;
            display: inline-block;
        }

        .blueprint-title::before, .blueprint-title::after {
            content: '‚óÜ';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent);
        }

        .blueprint-title::before { left: -40px; }
        .blueprint-title::after { right: -40px; }

        .subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 10px;
            letter-spacing: 3px;
        }

        .drawing-number {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 0.8rem;
            border: 1px solid var(--blueprint-line);
            padding: 5px 10px;
            transform: rotate(-2deg);
        }

        nav {
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--blueprint-line);
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        nav button {
            background: transparent;
            border: 2px solid var(--blueprint-line);
            color: white;
            padding: 10px 25px;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        nav button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        nav button.active {
            background: var(--blueprint-line);
            color: var(--blueprint-bg);
            font-weight: bold;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section { display: none; animation: fadeIn 0.5s; }
        .section.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Proxy Section - CroxyProxy Redirect */
        .proxy-container {
            border: 3px solid var(--blueprint-line);
            background: rgba(0, 0, 0, 0.2);
            padding: 30px;
            position: relative;
        }

        .proxy-container::before {
            content: 'CROXYPROXY MODULE v4.0';
            position: absolute;
            top: -12px;
            left: 30px;
            background: var(--blueprint-bg);
            padding: 0 15px;
            font-size: 0.9rem;
            letter-spacing: 2px;
        }

        .proxy-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .proxy-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--blueprint-line);
            color: white;
            padding: 15px;
            font-family: 'Courier Prime', monospace;
            font-size: 1rem;
            outline: none;
        }

        .proxy-input::placeholder { color: rgba(255, 255, 255, 0.5); }

        .proxy-btn {
            background: var(--accent);
            border: 2px solid var(--accent);
            color: white;
            padding: 15px 30px;
            font-family: 'Share Tech Mono', monospace;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s;
        }

        .proxy-btn:hover { background: transparent; color: var(--accent); }

        .proxy-options {
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--blueprint-line);
        }

        .proxy-row {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .mirror-select {
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--blueprint-line);
            color: white;
            padding: 8px;
            font-family: 'Courier Prime', monospace;
        }

        .mirror-select option {
            background: var(--blueprint-bg);
            color: white;
        }

        .quick-links {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .quick-link-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid var(--blueprint-line);
            color: white;
            padding: 10px;
            cursor: pointer;
            font-family: 'Share Tech Mono', monospace;
            text-transform: uppercase;
            font-size: 0.8rem;
            transition: all 0.3s;
        }

        .quick-link-btn:hover {
            background: var(--accent);
            border-color: var(--accent);
        }

        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .game-card {
            border: 2px solid var(--blueprint-line);
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            text-align: center;
            position: relative;
            transition: transform 0.3s;
            cursor: pointer;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            background: rgba(0, 0, 0, 0.4);
        }

        .game-icon { font-size: 3rem; margin-bottom: 15px; }
        
        .game-title {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .game-desc { font-size: 0.85rem; opacity: 0.8; margin-bottom: 15px; }

        .play-btn {
            display: inline-block;
            border: 2px solid var(--accent);
            color: var(--accent);
            padding: 8px 20px;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .play-btn:hover { background: var(--accent); color: white; }

        /* External Game Container */
        .external-game-container {
            border: 3px solid var(--blueprint-line);
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            margin-top: 20px;
            position: relative;
            display: none;
            height: 80vh;
        }

        .external-game-container.active { display: block; }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--blueprint-line);
        }

        .back-btn {
            background: var(--accent);
            border: none;
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            font-family: 'Share Tech Mono', monospace;
        }

        .external-frame {
            width: 100%;
            height: calc(100% - 60px);
            border: 2px solid var(--blueprint-line);
            background: white;
        }

        /* Local Game Container */
        .local-game-container {
            border: 3px solid var(--blueprint-line);
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            margin-top: 20px;
            position: relative;
            display: none;
        }

        .local-game-container.active { display: block; }

        canvas {
            display: block;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--blueprint-line);
            max-width: 100%;
        }

        .game-controls {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 2px 8px;
            font-size: 0.7rem;
            margin-left: 5px;
            text-transform: uppercase;
        }

        .badge.official { background: #228B22; }
        .badge.local { background: #4169E1; }

        /* Tools */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .tool-box {
            border: 2px solid var(--blueprint-line);
            padding: 25px;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
        }

        .tool-box h3 {
            font-family: 'Share Tech Mono', monospace;
            margin-bottom: 15px;
            color: var(--warning);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .calc-display {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--blueprint-line);
            padding: 15px;
            margin-bottom: 15px;
            text-align: right;
            font-size: 1.5rem;
            font-family: 'Share Tech Mono', monospace;
            min-height: 50px;
            word-wrap: break-word;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .calc-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px;
            font-family: 'Courier Prime', monospace;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .calc-btn:hover { background: rgba(255, 255, 255, 0.3); transform: scale(1.05); }
        .calc-btn.operator { background: var(--accent); border-color: var(--accent); }

        @media (max-width: 768px) {
            .blueprint-title { font-size: 2rem; }
            .blueprint-title::before, .blueprint-title::after { display: none; }
            .proxy-input-group { flex-direction: column; }
            .proxy-row { flex-direction: column; align-items: flex-start; }
            canvas { max-width: 100%; }
        }

        footer {
            text-align: center;
            padding: 30px;
            border-top: 3px double var(--blueprint-line);
            margin-top: 50px;
            font-size: 0.8rem;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="tech-border top-left"></div>
    <div class="tech-border top-right"></div>
    <div class="tech-border bottom-left"></div>
    <div class="tech-border bottom-right"></div>

    <header>
        <div class="drawing-number">DWG: LEMONS-PROXY-v4.0</div>
        <h1 class="blueprint-title">Lemons Proxy</h1>
        <p class="subtitle">Educational Resource Portal with CroxyProxy</p>
    </header>

    <nav>
        <button class="nav-btn active" onclick="showSection('proxy')">Proxy</button>
        <button class="nav-btn" onclick="showSection('games')">Arcade</button>
        <button class="nav-btn" onclick="showSection('tools')">Tools</button>
    </nav>

    <div class="container">
        <!-- Proxy Section - Uses CroxyProxy Redirect -->
        <section id="proxy" class="section active">
            <div class="proxy-container">
                <div class="proxy-input-group">
                    <input type="text" class="proxy-input" id="urlInput" placeholder="Enter URL (e.g., https://example.com)" onkeypress="if(event.key==='Enter')openProxy()">
                    <button class="proxy-btn" onclick="openProxy()">LAUNCH PROXY</button>
                </div>
                
                <div class="proxy-options">
                    <div class="proxy-row">
                        <span>Service:</span>
                        <select id="proxyService" class="mirror-select" style="flex: 1;">
                            <option value="https://www.croxyproxy.com/_proxy?url=">CroxyProxy (Recommended)</option>
                            <option value="https://proxyium.com/?q=">Proxyium</option>
                            <option value="https://www.blockaway.net/_proxy?url=">BlockAway</option>
                            <option value="https://plainproxies.com/_proxy?url=">PlainProxies</option>
                        </select>
                    </div>
                    <div class="proxy-row">
                        <label><input type="checkbox" id="stealthMode"> Stealth Mode (Disguise Tab Title)</label>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.3);">
                    <h3 style="font-family: 'Share Tech Mono'; margin-bottom: 10px; color: var(--warning);">How It Works</h3>
                    <p style="font-size: 0.9rem; line-height: 1.6;">
                        This proxy uses CroxyProxy technology to bypass restrictions. Click "LAUNCH PROXY" to open the target site in a secure, encrypted connection. 
                        If one service doesn't work, try another from the dropdown.
                    </p>
                </div>

                <div style="margin-top: 20px;">
                    <h3 style="font-family: 'Share Tech Mono'; margin-bottom: 15px;">Quick Launch</h3>
                    <div class="quick-links">
                        <button class="quick-link-btn" onclick="quickProxy('https://google.com')">Google</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://youtube.com')">YouTube</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://reddit.com')">Reddit</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://discord.com')">Discord</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://twitter.com')">Twitter</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://wikipedia.org')">Wikipedia</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://instagram.com')">Instagram</button>
                        <button class="quick-link-btn" onclick="quickProxy('https://tiktok.com')">TikTok</button>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: rgba(255,0,0,0.1); border: 1px solid rgba(255,0,0,0.3);">
                    <h3 style="font-family: 'Share Tech Mono'; margin-bottom: 10px; color: #ff6666;">Notice</h3>
                    <p style="font-size: 0.85rem;">
                        This proxy opens sites in a new tab using web proxy services. If links don't open, check your popup blocker or try a different service from the dropdown.
                    </p>
                </div>
            </div>
        </section>

        <!-- Games Section - Based on Genizy Math -->
        <section id="games" class="section">
            <div id="gamesMenu">
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; border: 2px dashed rgba(255,255,255,0.3);">
                    <h2 style="font-family: 'Share Tech Mono', monospace; letter-spacing: 3px;">ARCADE MODULE</h2>
                    <p style="margin-top: 10px; opacity: 0.8;">Based on Genizy Math Collection</p>
                </div>

                <div class="games-grid">
                    <!-- Genizy Math Style Games - External Hosted -->
                    <div class="game-card" onclick="launchExternal('https://g.deev.is/eaglercraft/', 'Eaglercraft - Minecraft 1.5.2')">
                        <div class="game-icon">‚õèÔ∏è</div>
                        <div class="game-title">Eaglercraft <span class="badge official">Online</span></div>
                        <div class="game-desc">Minecraft Java 1.5.2 in your browser. Singleplayer & Multiplayer support.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://eaglercraftx.net/', 'EaglercraftX 1.8.8')">
                        <div class="game-icon">ü™ì</div>
                        <div class="game-title">EaglercraftX <span class="badge official">Online</span></div>
                        <div class="game-desc">Minecraft Java 1.8.8 with improved performance.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://scratch.mit.edu/projects/10128407/embed', 'Papa\'s Pizzeria')">
                        <div class="game-icon">üçï</div>
                        <div class="game-title">Papa's Pizzeria <span class="badge official">Flash</span></div>
                        <div class="game-desc">Classic cooking game. Manage your own pizza shop.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://amanda-the-adventurer.com/game/amanda-the-adventurer/', 'Amanda the Adventurer')">
                        <div class="game-icon">üìº</div>
                        <div class="game-title">Amanda Adventurer <span class="badge official">Horror</span></div>
                        <div class="game-desc">Help Amanda solve puzzles in this horror adventure.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://foddy.net/Athletics.html?webgl=true', 'QWOP')">
                        <div class="game-icon">üèÉ</div>
                        <div class="game-title">QWOP <span class="badge official">Classic</span></div>
                        <div class="game-desc">The hardest running game ever made.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://diep.io/', 'Diep.io')">
                        <div class="game-icon">üî´</div>
                        <div class="game-title">Diep.io <span class="badge official">.io</span></div>
                        <div class="game-desc">Multiplayer tank warfare. Level up and destroy.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://slither.io/', 'Slither.io')">
                        <div class="game-icon">üêç</div>
                        <div class="game-title">Slither.io <span class="badge official">.io</span></div>
                        <div class="game-desc">Snake MMO. Eat or be eaten.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://agar.io/', 'Agar.io')">
                        <div class="game-icon">‚ö™</div>
                        <div class="game-title">Agar.io <span class="badge official">.io</span></div>
                        <div class="game-desc">Cell eating multiplayer game.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://krunker.io/', 'Krunker.io')">
                        <div class="game-icon">üî´</div>
                        <div class="game-title">Krunker.io <span class="badge official">FPS</span></div>
                        <div class="game-desc">Fast-paced pixel FPS with classes.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://crazy-cattle-3d.com/', 'Crazy Cattle 3D')">
                        <div class="game-icon">üêÑ</div>
                        <div class="game-title">Crazy Cattle 3D <span class="badge official">3D</span></div>
                        <div class="game-desc">Explosive sheep action game.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <div class="game-card" onclick="launchExternal('https://drivemad.com/', 'Drive Mad')">
                        <div class="game-icon">üèéÔ∏è</div>
                        <div class="game-title">Drive Mad <span class="badge official">Racing</span></div>
                        <div class="game-desc">Physics-based driving game.</div>
                        <span class="play-btn">Play Now</span>
                    </div>

                    <!-- Local Games -->
                    <div class="game-card" onclick="launchLocal('snake')">
                        <div class="game-icon">üêç</div>
                        <div class="game-title">Snake <span class="badge local">Local</span></div>
                        <div class="game-desc">Classic arcade game built-in.</div>
                        <span class="play-btn">Play</span>
                    </div>

                    <div class="game-card" onclick="launchLocal('pong')">
                        <div class="game-icon">üèì</div>
                        <div class="game-title">Pong <span class="badge local">Local</span></div>
                        <div class="game-desc">Original table tennis vs AI.</div>
                        <span class="play-btn">Play</span>
                    </div>

                    <div class="game-card" onclick="launchLocal('tetris')">
                        <div class="game-icon">üß±</div>
                        <div class="game-title">Tetris <span class="badge local">Local</span></div>
                        <div class="game-desc">Block stacking puzzle.</div>
                        <span class="play-btn">Play</span>
                    </div>

                    <div class="game-card" onclick="launchLocal('minesweeper')">
                        <div class="game-icon">üí£</div>
                        <div class="game-title">Minesweeper <span class="badge local">Local</span></div>
                        <div class="game-desc">Clear the minefield safely.</div>
                        <span class="play-btn">Play</span>
                    </div>

                    <div class="game-card" onclick="launchLocal('flappy')">
                        <div class="game-icon">üê¶</div>
                        <div class="game-title">Flappy Bird <span class="badge local">Local</span></div>
                        <div class="game-desc">Navigate through pipes.</div>
                        <span class="play-btn">Play</span>
                    </div>

                    <div class="game-card" onclick="launchLocal('2048')">
                        <div class="game-icon">üî¢</div>
                        <div class="game-title">2048 <span class="badge local">Local</span></div>
                        <div class="game-desc">Slide tiles to win.</div>
                        <span class="play-btn">Play</span>
                    </div>
                </div>
            </div>

            <!-- External Game Viewer -->
            <div id="externalGameContainer" class="external-game-container">
                <div class="game-header">
                    <h2 id="externalGameTitle" style="font-family: 'Share Tech Mono', monospace;">Game Title</h2>
                    <div>
                        <button class="back-btn" onclick="closeExternal()" style="margin-right: 10px;">Back to Arcade</button>
                        <button class="proxy-btn" onclick="toggleFullscreen()">Fullscreen</button>
                    </div>
                </div>
                <iframe id="externalFrame" class="external-frame" allowfullscreen></iframe>
            </div>

            <!-- Local Game Viewer -->
            <div id="localGameContainer" class="local-game-container">
                <div class="game-header">
                    <h2 id="localGameTitle" style="font-family: 'Share Tech Mono', monospace;">Game Title</h2>
                    <button class="back-btn" onclick="closeLocal()">Exit Game</button>
                </div>
                <div id="localGameCanvas"></div>
                <div class="game-controls" id="localGameControls"></div>
            </div>
        </section>

        <!-- Tools Section -->
        <section id="tools" class="section">
            <div class="tools-grid">
                <div class="tool-box">
                    <h3>Calculator</h3>
                    <div class="calc-display" id="calcDisplay">0</div>
                    <div class="calc-buttons">
                        <button class="calc-btn" onclick="calcClear()">C</button>
                        <button class="calc-btn" onclick="calcAppend('(')">(</button>
                        <button class="calc-btn" onclick="calcAppend(')')">)</button>
                        <button class="calc-btn operator" onclick="calcOp('/')">/</button>
                        
                        <button class="calc-btn" onclick="calcAppend('7')">7</button>
                        <button class="calc-btn" onclick="calcAppend('8')">8</button>
                        <button class="calc-btn" onclick="calcAppend('9')">9</button>
                        <button class="calc-btn operator" onclick="calcOp('*')">√ó</button>
                        
                        <button class="calc-btn" onclick="calcAppend('4')">4</button>
                        <button class="calc-btn" onclick="calcAppend('5')">5</button>
                        <button class="calc-btn" onclick="calcAppend('6')">6</button>
                        <button class="calc-btn operator" onclick="calcOp('-')">-</button>
                        
                        <button class="calc-btn" onclick="calcAppend('1')">1</button>
                        <button class="calc-btn" onclick="calcAppend('2')">2</button>
                        <button class="calc-btn" onclick="calcAppend('3')">3</button>
                        <button class="calc-btn operator" onclick="calcOp('+')">+</button>
                        
                        <button class="calc-btn" onclick="calcAppend('0')">0</button>
                        <button class="calc-btn" onclick="calcAppend('.')">.</button>
                        <button class="calc-btn" onclick="calcBack()">‚Üê</button>
                        <button class="calc-btn operator" onclick="calcEquals()">=</button>
                    </div>
                </div>

                <div class="tool-box">
                    <h3>Base64 Encoder</h3>
                    <textarea class="proxy-input" id="base64Input" rows="4" style="width: 100%; resize: vertical; margin-bottom: 10px;" placeholder="Enter text..."></textarea>
                    <div style="display: flex; gap: 10px;">
                        <button class="proxy-btn" onclick="encodeBase64()" style="flex: 1;">Encode</button>
                        <button class="proxy-btn" onclick="decodeBase64()" style="flex: 1;">Decode</button>
                    </div>
                    <div id="base64Output" style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid var(--blueprint-line); word-break: break-all; min-height: 40px;"></div>
                </div>

                <div class="tool-box">
                    <h3>URL Tools</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="calc-btn" style="text-align: left;" onclick="copyCurrentURL()">Copy Current URL</button>
                        <button class="calc-btn" style="text-align: left;" onclick="openNewTab()">Open New Tab</button>
                        <button class="calc-btn" style="text-align: left;" onclick="document.getElementById('urlInput').focus()">Focus Proxy Input</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>Lemons Proxy v4.0 | CroxyProxy Integration | Based on Genizy Math</p>
        <p style="margin-top: 10px; font-size: 0.7rem;">Not affiliated with Genizy Math - Educational use only</p>
    </footer>

    <script>
        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            if (sectionId !== 'games') {
                closeExternal();
                closeLocal();
            }
        }

        // PROXY FUNCTIONALITY - Opens in new tab like CroxyProxy
        function openProxy() {
            const url = document.getElementById('urlInput').value;
            const service = document.getElementById('proxyService').value;
            const stealth = document.getElementById('stealthMode').checked;
            
            if (!url) {
                alert('Please enter a URL');
                return;
            }

            let targetUrl = url;
            if (!url.startsWith('http')) {
                targetUrl = 'https://' + url;
            }

            // Construct proxy URL
            const fullUrl = service + encodeURIComponent(targetUrl);
            
            // Open in new tab
            const newTab = window.open(fullUrl, '_blank');
            
            if (!newTab || newTab.closed || typeof newTab.closed == 'undefined') {
                alert('Popup was blocked. Please allow popups for this site to use the proxy.');
            } else {
                if (stealth) {
                    document.title = 'Google Docs';
                }
            }
        }

        function quickProxy(url) {
            document.getElementById('urlInput').value = url;
            openProxy();
        }

        // External Games
        function launchExternal(url, title) {
            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('externalGameContainer').classList.add('active');
            document.getElementById('externalGameTitle').textContent = title;
            document.getElementById('externalFrame').src = url;
        }

        function closeExternal() {
            document.getElementById('externalGameContainer').classList.remove('active');
            document.getElementById('gamesMenu').style.display = 'block';
            document.getElementById('externalFrame').src = '';
        }

        function toggleFullscreen() {
            const elem = document.getElementById('externalGameContainer');
            if (!document.fullscreenElement) {
                elem.requestFullscreen().catch(err => {
                    alert('Error attempting to enable fullscreen: ' + err.message);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Local Games System
        let gameLoop = null;

        function launchLocal(gameType) {
            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('localGameContainer').classList.add('active');
            const canvas = document.getElementById('localGameCanvas');
            canvas.innerHTML = '';
            
            switch(gameType) {
                case 'snake':
                    document.getElementById('localGameTitle').textContent = 'SNAKE';
                    document.getElementById('localGameControls').textContent = 'Arrow Keys: Move';
                    initSnake(canvas);
                    break;
                case 'pong':
                    document.getElementById('localGameTitle').textContent = 'PONG';
                    document.getElementById('localGameControls').textContent = 'Mouse: Control Paddle';
                    initPong(canvas);
                    break;
                case 'tetris':
                    document.getElementById('localGameTitle').textContent = 'TETRIS';
                    document.getElementById('localGameControls').textContent = 'Arrows: Move/Rotate | Down: Soft Drop | Space: Hard Drop';
                    initTetris(canvas);
                    break;
                case 'minesweeper':
                    document.getElementById('localGameTitle').textContent = 'MINESWEEPER';
                    document.getElementById('localGameControls').textContent = 'Left Click: Reveal | Right Click: Flag';
                    initMinesweeper(canvas);
                    break;
                case 'flappy':
                    document.getElementById('localGameTitle').textContent = 'FLAPPY BIRD';
                    document.getElementById('localGameControls').textContent = 'Space/Click: Jump';
                    initFlappy(canvas);
                    break;
                case '2048':
                    document.getElementById('localGameTitle').textContent = '2048';
                    document.getElementById('localGameControls').textContent = 'Arrow Keys: Slide Tiles';
                    init2048(canvas);
                    break;
            }
        }

        function closeLocal() {
            document.getElementById('localGameContainer').classList.remove('active');
            document.getElementById('gamesMenu').style.display = 'block';
            if (gameLoop) cancelAnimationFrame(gameLoop);
        }

        // Game implementations (same as before - fully working)
        function initSnake(container) {
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 400;
            container.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            const grid = 20;
            let count = 0;
            let score = 0;
            
            const snake = { x: 160, y: 160, dx: grid, dy: 0, cells: [], maxCells: 4 };
            const apple = { x: 320, y: 320 };
            
            function reset() {
                snake.x = 160; snake.y = 160; snake.cells = []; snake.maxCells = 4;
                snake.dx = grid; snake.dy = 0;
                apple.x = Math.floor(Math.random() * 20) * grid;
                apple.y = Math.floor(Math.random() * 20) * grid;
                score = 0;
            }
            
            function loop() {
                gameLoop = requestAnimationFrame(loop);
                if (++count < 4) return;
                count = 0;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                snake.x += snake.dx; snake.y += snake.dy;
                
                if (snake.x < 0 || snake.x >= canvas.width || snake.y < 0 || snake.y >= canvas.height) {
                    reset(); return;
                }
                
                snake.cells.unshift({x: snake.x, y: snake.y});
                if (snake.cells.length > snake.maxCells) snake.cells.pop();
                
                ctx.fillStyle = 'red';
                ctx.fillRect(apple.x, apple.y, grid-1, grid-1);
                ctx.fillStyle = 'green';
                snake.cells.forEach((cell, index) => {
                    ctx.fillRect(cell.x, cell.y, grid-1, grid-1);
                    if (cell.x === apple.x && cell.y === apple.y) {
                        snake.maxCells++; score++;
                        apple.x = Math.floor(Math.random() * 20) * grid;
                        apple.y = Math.floor(Math.random() * 20) * grid;
                    }
                    for (let i = index + 1; i < snake.cells.length; i++) {
                        if (cell.x === snake.cells[i].x && cell.y === snake.cells[i].y) reset();
                    }
                });
                ctx.fillStyle = 'white';
                ctx.font = '20px monospace';
                ctx.fillText('Score: ' + score, 10, 30);
            }
            
            document.addEventListener('keydown', function handler(e) {
                if (e.which === 37 && snake.dx === 0) { snake.dx = -grid; snake.dy = 0; }
                else if (e.which === 38 && snake.dy === 0) { snake.dy = -grid; snake.dx = 0; }
                else if (e.which === 39 && snake.dx === 0) { snake.dx = grid; snake.dy = 0; }
                else if (e.which === 40 && snake.dy === 0) { snake.dy = grid; snake.dx = 0; }
            });
            gameLoop = requestAnimationFrame(loop);
        }

        function initPong(container) {
            const canvas = document.createElement('canvas');
            canvas.width = 750; canvas.height = 585;
            container.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            const grid = 15;
            const paddleHeight = grid * 5;
            const maxPaddleY = canvas.height - grid - paddleHeight;
            let paddleSpeed = 6, ballSpeed = 5;
            let playerScore = 0, aiScore = 0;
            
            const leftPaddle = { x: grid * 2, y: canvas.height / 2 - paddleHeight / 2, width: grid, height: paddleHeight, dy: 0 };
            const rightPaddle = { x: canvas.width - grid * 3, y: canvas.height / 2 - paddleHeight / 2, width: grid, height: paddleHeight, dy: 0 };
            const ball = { x: canvas.width / 2, y: canvas.height / 2, width: grid, height: grid, resetting: false, dx: ballSpeed, dy: -ballSpeed };
            
            function loop() {
                gameLoop = requestAnimationFrame(loop);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                leftPaddle.y += leftPaddle.dy;
                if (leftPaddle.y < grid) leftPaddle.y = grid;
                if (leftPaddle.y > maxPaddleY) leftPaddle.y = maxPaddleY;
                
                rightPaddle.dy = (ball.y < rightPaddle.y + rightPaddle.height/2) ? -paddleSpeed * 0.8 : paddleSpeed * 0.8;
                rightPaddle.y += rightPaddle.dy;
                if (rightPaddle.y < grid) rightPaddle.y = grid;
                if (rightPaddle.y > maxPaddleY) rightPaddle.y = maxPaddleY;
                
                ball.x += ball.dx; ball.y += ball.dy;
                if (ball.y < grid || ball.y + grid > canvas.height - grid) ball.dy *= -1;
                
                if ((ball.x < 0 || ball.x > canvas.width) && !ball.resetting) {
                    if (ball.x < 0) aiScore++; else playerScore++;
                    ball.resetting = true;
                    setTimeout(() => {
                        ball.resetting = false;
                        ball.x = canvas.width / 2; ball.y = canvas.height / 2;
                        ball.dx = ballSpeed * (Math.random() > 0.5 ? 1 : -1);
                        ball.dy = ballSpeed * (Math.random() > 0.5 ? 1 : -1);
                    }, 1000);
                }
                
                if (ball.x < leftPaddle.x + leftPaddle.width && ball.y > leftPaddle.y && ball.y < leftPaddle.y + leftPaddle.height) {
                    ball.dx *= -1; ball.x = leftPaddle.x + leftPaddle.width;
                }
                if (ball.x + ball.width > rightPaddle.x && ball.y > rightPaddle.y && ball.y < rightPaddle.y + rightPaddle.height) {
                    ball.dx *= -1; ball.x = rightPaddle.x - ball.width;
                }
                
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, grid);
                ctx.fillRect(0, canvas.height - grid, canvas.width, canvas.height);
                for (let i = grid; i < canvas.height - grid; i += grid * 2) ctx.fillRect(canvas.width / 2 - grid / 2, i, grid, grid);
                ctx.fillRect(leftPaddle.x, leftPaddle.y, leftPaddle.width, leftPaddle.height);
                ctx.fillRect(rightPaddle.x, rightPaddle.y, rightPaddle.width, rightPaddle.height);
                ctx.fillRect(ball.x, ball.y, ball.width, ball.height);
                ctx.font = '30px monospace';
                ctx.fillText(playerScore, canvas.width / 4, 50);
                ctx.fillText(aiScore, 3 * canvas.width / 4, 50);
            }
            
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                leftPaddle.y = e.clientY - rect.top - leftPaddle.height / 2;
            });
            gameLoop = requestAnimationFrame(loop);
        }

        function initTetris(container) {
            const canvas = document.createElement('canvas');
            canvas.width = 240; canvas.height = 400;
            container.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            ctx.scale(20, 20);
            
            const arena = createMatrix(12, 20);
            const player = { pos: {x: 0, y: 0}, matrix: null, score: 0 };
            const pieces = 'ILJOTSZ';
            
            function createMatrix(w, h) { const m = []; while (h--) m.push(new Array(w).fill(0)); return m; }
            function createPiece(type) {
                if (type === 'I') return [[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]];
                if (type === 'L') return [[0,2,0],[0,2,0],[0,2,2]];
                if (type === 'J') return [[0,3,0],[0,3,0],[3,3,0]];
                if (type === 'O') return [[4,4],[4,4]];
                if (type === 'Z') return [[5,5,0],[0,5,5],[0,0,0]];
                if (type === 'S') return [[0,6,6],[6,6,0],[0,0,0]];
                if (type === 'T') return [[0,7,0],[7,7,7],[0,0,0]];
            }
            
            function draw() {
                ctx.fillStyle = '#000'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                drawMatrix(arena, {x: 0, y: 0}); drawMatrix(player.matrix, player.pos);
                ctx.fillStyle = 'white'; ctx.font = '0.5px monospace'; ctx.fillText('Score: ' + player.score, 0.2, 0.5);
            }
            function drawMatrix(matrix, offset) {
                matrix.forEach((row, y) => row.forEach((value, x) => {
                    if (value !== 0) { ctx.fillStyle = ['','cyan','blue','orange','yellow','green','red','purple'][value]; ctx.fillRect(x + offset.x, y + offset.y, 1, 1); }
                }));
            }
            function merge(arena, player) { player.matrix.forEach((row, y) => row.forEach((value, x) => { if (value !== 0) arena[y + player.pos.y][x + player.pos.x] = value; })); }
            function rotate(matrix) { return matrix.map((val, index) => matrix.map(row => row[index]).reverse()); }
            function collide(arena, player) { const m = player.matrix, o = player.pos; for (let y = 0; y < m.length; ++y) for (let x = 0; x < m[y].length; ++x) if (m[y][x] !== 0 && (arena[y + o.y] && arena[y + o.y][x + o.x]) !== 0) return true; return false; }
            function playerReset() { player.matrix = createPiece(pieces[pieces.length * Math.random() | 0]); player.pos.y = 0; player.pos.x = (arena[0].length / 2 | 0) - (player.matrix[0].length / 2 | 0); if (collide(arena, player)) { arena.forEach(row => row.fill(0)); player.score = 0; } }
            function arenaSweep() { let rowCount = 1; outer: for (let y = arena.length -1; y > 0; --y) { for (let x = 0; x < arena[y].length; ++x) if (arena[y][x] === 0) continue outer; const row = arena.splice(y, 1)[0].fill(0); arena.unshift(row); ++y; player.score += rowCount * 10; rowCount *= 2; } }
            function playerDrop() { player.pos.y++; if (collide(arena, player)) { player.pos.y--; merge(arena, player); playerReset(); arenaSweep(); } dropCounter = 0; }
            
            let dropCounter = 0, dropInterval = 1000, lastTime = 0;
            function update(time = 0) { const deltaTime = time - lastTime; lastTime = time; dropCounter += deltaTime; if (dropCounter > dropInterval) playerDrop(); draw(); gameLoop = requestAnimationFrame(update); }
            
            document.addEventListener('keydown', event => {
                if (event.keyCode === 37) { player.pos.x--; if (collide(arena, player)) player.pos.x++; }
                else if (event.keyCode === 39) { player.pos.x++; if (collide(arena, player)) player.pos.x--; }
                else if (event.keyCode === 40) playerDrop();
                else if (event.keyCode === 38) { player.matrix = rotate(player.matrix); if (collide(arena, player)) player.matrix = rotate(player.matrix); }
                else if (event.keyCode === 32) { while (!collide(arena, player)) player.pos.y++; player.pos.y--; playerDrop(); }
            });
            playerReset(); gameLoop = requestAnimationFrame(update);
        }

        function initMinesweeper(container) {
            const width = 10, height = 10, bombCount = 20;
            const grid = document.createElement('div');
            grid.style.display = 'grid'; grid.style.gridTemplateColumns = 'repeat(10, 30px)'; grid.style.gap = '2px';
            grid.style.margin = '0 auto'; grid.style.width = 'fit-content';
            const squares = []; let isGameOver = false, flags = 0;
            
            const shuffledArray = Array(bombCount).fill('bomb').concat(Array(width * height - bombCount).fill('valid')).sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < width * height; i++) {
                const square = document.createElement('div');
                square.setAttribute('id', i); square.className = shuffledArray[i];
                square.style.cssText = 'width: 30px; height: 30px; background: #aaa; border: 2px solid white; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 14px; font-weight: bold;';
                grid.appendChild(square); squares.push(square);
                square.addEventListener('click', () => click(square));
                square.oncontextmenu = (e) => { e.preventDefault(); addFlag(square); }
            }
            
            for (let i = 0; i < squares.length; i++) {
                let total = 0; const isLeft = (i % width === 0), isRight = (i % width === width - 1);
                if (squares[i].classList.contains('valid')) {
                    if (i > 0 && !isLeft && squares[i-1].classList.contains('bomb')) total++;
                    if (i > 9 && !isRight && squares[i+1-width].classList.contains('bomb')) total++;
                    if (i > 10 && squares[i-width].classList.contains('bomb')) total++;
                    if (i > 11 && !isLeft && squares[i-1-width].classList.contains('bomb')) total++;
                    if (i < 98 && !isRight && squares[i+1].classList.contains('bomb')) total++;
                    if (i < 90 && !isLeft && squares[i-1+width].classList.contains('bomb')) total++;
                    if (i < 88 && !isRight && squares[i+1+width].classList.contains('bomb')) total++;
                    if (i < 89 && squares[i+width].classList.contains('bomb')) total++;
                    squares[i].setAttribute('data', total);
                }
            }
            
            function addFlag(square) {
                if (isGameOver || square.classList.contains('checked')) return;
                if (!square.classList.contains('flag') && flags < bombCount) { square.classList.add('flag'); square.textContent = 'üö©'; flags++; }
                else if (square.classList.contains('flag')) { square.classList.remove('flag'); square.textContent = ''; flags--; }
            }
            function click(square) {
                if (isGameOver || square.classList.contains('checked') || square.classList.contains('flag')) return;
                if (square.classList.contains('bomb')) { gameOver(); return; }
                let total = square.getAttribute('data');
                if (total != 0) { square.classList.add('checked'); square.textContent = total; square.style.background = '#ddd'; 
                    if (total == 1) square.style.color = 'blue'; if (total == 2) square.style.color = 'green';
                    if (total == 3) square.style.color = 'red'; if (total == 4) square.style.color = 'navy'; }
                else { checkSquare(square); }
            }
            function checkSquare(square) {
                const curr = parseInt(square.id), isLeft = (curr % width === 0), isRight = (curr % width === width - 1);
                setTimeout(() => {
                    if (curr > 0 && !isLeft) click(squares[curr-1]); if (curr > 9 && !isRight) click(squares[curr+1-width]);
                    if (curr > 10) click(squares[curr-width]); if (curr > 11 && !isLeft) click(squares[curr-1-width]);
                    if (curr < 98 && !isRight) click(squares[curr+1]); if (curr < 90 && !isLeft) click(squares[curr-1+width]);
                    if (curr < 88 && !isRight) click(squares[curr+1+width]); if (curr < 89) click(squares[curr+width]);
                }, 10);
            }
            function gameOver() { isGameOver = true; squares.forEach(s => { if (s.classList.contains('bomb')) { s.textContent = 'üí£'; s.style.background = 'red'; } }); setTimeout(() => alert('Game Over!'), 10); }
            container.appendChild(grid);
        }

        function initFlappy(container) {
            const canvas = document.createElement('canvas');
            canvas.width = 320; canvas.height = 480;
            container.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            let birdY = 150, birdVelocity = 0, birdAcceleration = 0.2, isGameOver = false, score = 0, pipes = [], frames = 0;
            
            function reset() { birdY = 150; birdVelocity = 0; isGameOver = false; score = 0; pipes = []; frames = 0; }
            function jump() { if (!isGameOver) birdVelocity = -5; }
            
            function update() {
                if (isGameOver) return;
                ctx.fillStyle = 'skyblue'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                birdVelocity += birdAcceleration; birdY += birdVelocity;
                if (frames % 100 === 0) { const pipeHeight = Math.random() * 200 + 50, gap = 120; pipes.push({ x: canvas.width, width: 40, top: pipeHeight, bottom: canvas.height - pipeHeight - gap, passed: false }); }
                pipes.forEach((pipe, index) => {
                    pipe.x -= 2; if (!pipe.passed && pipe.x + pipe.width < 50) { score++; pipe.passed = true; } if (pipe.x + pipe.width < 0) pipes.splice(index, 1);
                    if (50 + 10 > pipe.x && 50 - 10 < pipe.x + pipe.width) if (birdY - 10 < pipe.top || birdY + 10 > canvas.height - pipe.bottom) { isGameOver = true; setTimeout(() => { alert('Game Over! Score: ' + score); reset(); update(); }, 10); }
                });
                if (birdY < 0 || birdY > canvas.height) { isGameOver = true; setTimeout(() => { alert('Game Over! Score: ' + score); reset(); update(); }, 10); }
                ctx.fillStyle = 'green'; pipes.forEach(pipe => { ctx.fillRect(pipe.x, 0, pipe.width, pipe.top); ctx.fillRect(pipe.x, canvas.height - pipe.bottom, pipe.width, pipe.bottom); });
                ctx.fillStyle = 'yellow'; ctx.beginPath(); ctx.arc(50, birdY, 10, 0, Math.PI * 2); ctx.fill();
                ctx.fillStyle = 'white'; ctx.font = '20px Arial'; ctx.fillText('Score: ' + score, 10, 30);
                frames++; gameLoop = requestAnimationFrame(update);
            }
            canvas.addEventListener('click', jump);
            document.addEventListener('keydown', (e) => { if (e.code === 'Space') { e.preventDefault(); jump(); }});
            gameLoop = requestAnimationFrame(update);
        }

        function init2048(container) {
            const gridSize = 4; let grid = [], score = 0;
            const gameDiv = document.createElement('div');
            gameDiv.style.cssText = 'width: 340px; margin: 0 auto; background: #bbada0; padding: 10px; border-radius: 6px;';
            const scoreDiv = document.createElement('div'); scoreDiv.style.cssText = 'text-align: center; margin-bottom: 10px; font-size: 24px; font-weight: bold;'; scoreDiv.textContent = 'Score: 0'; gameDiv.appendChild(scoreDiv);
            const gridDiv = document.createElement('div'); gridDiv.style.cssText = 'display: grid; grid-template-columns: repeat(4, 75px); gap: 10px;';
            
            function initGrid() { grid = Array(gridSize).fill().map(() => Array(gridSize).fill(0)); addRandom(); addRandom(); update(); }
            function addRandom() { const avail = []; for (let r = 0; r < gridSize; r++) for (let c = 0; c < gridSize; c++) if (grid[r][c] === 0) avail.push({r, c}); if (avail.length > 0) { const {r, c} = avail[Math.floor(Math.random() * avail.length)]; grid[r][c] = Math.random() < 0.9 ? 2 : 4; } }
            function update() {
                gridDiv.innerHTML = ''; for (let r = 0; r < gridSize; r++) for (let c = 0; c < gridSize; c++) {
                    const cell = document.createElement('div'); cell.style.cssText = `width: 75px; height: 75px; background: ${getColor(grid[r][c])}; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; color: ${grid[r][c] > 4 ? 'white' : '#776e65'}; border-radius: 3px;`;
                    cell.textContent = grid[r][c] || ''; gridDiv.appendChild(cell);
                } scoreDiv.textContent = 'Score: ' + score;
            }
            function getColor(v) { const c = {0: '#cdc1b4', 2: '#eee4da', 4: '#ede0c8', 8: '#f2b179', 16: '#f59563', 32: '#f67c5f', 64: '#f65e3b', 128: '#edcf72', 256: '#edcc61', 512: '#edc850', 1024: '#edc53f', 2048: '#edc22e'}; return c[v] || '#3c3a32'; }
            function move(dir) {
                let moved = false; const newGrid = grid.map(r => [...r]);
                if (dir === 'left' || dir === 'right') for (let r = 0; r < gridSize; r++) {
                    let row = newGrid[r].filter(v => v); if (dir === 'right') row.reverse();
                    for (let i = 0; i < row.length - 1; i++) if (row[i] === row[i+1]) { row[i] *= 2; score += row[i]; row.splice(i+1, 1); moved = true; }
                    while (row.length < gridSize) row.push(0); if (dir === 'right') row.reverse();
                    for (let c = 0; c < gridSize; c++) { if (newGrid[r][c] !== row[c]) moved = true; newGrid[r][c] = row[c]; }
                } else for (let c = 0; c < gridSize; c++) {
                    let col = []; for (let r = 0; r < gridSize; r++) col.push(newGrid[r][c]); col = col.filter(v => v); if (dir === 'down') col.reverse();
                    for (let i = 0; i < col.length - 1; i++) if (col[i] === col[i+1]) { col[i] *= 2; score += col[i]; col.splice(i+1, 1); moved = true; }
                    while (col.length < gridSize) col.push(0); if (dir === 'down') col.reverse();
                    for (let r = 0; r < gridSize; r++) { if (newGrid[r][c] !== col[r]) moved = true; newGrid[r][c] = col[r]; }
                }
                if (moved) { grid = newGrid; addRandom(); update(); if (isOver()) setTimeout(() => alert('Game Over! Score: ' + score), 100); }
            }
            function isOver() { for (let r = 0; r < gridSize; r++) for (let c = 0; c < gridSize; c++) { if (grid[r][c] === 0) return false; if (c < gridSize - 1 && grid[r][c] === grid[r][c+1]) return false; if (r < gridSize - 1 && grid[r][c] === grid[r+1][c]) return false; } return true; }
            document.addEventListener('keydown', (e) => { switch(e.key) { case 'ArrowUp': move('up'); break; case 'ArrowDown': move('down'); break; case 'ArrowLeft': move('left'); break; case 'ArrowRight': move('right'); break; }});
            gameDiv.appendChild(gridDiv); container.appendChild(gameDiv); initGrid();
        }

        // Calculator Tools
        let calcExpression = '';
        function calcAppend(v) { if (document.getElementById('calcDisplay').textContent === '0' && v !== '.') calcExpression = v; else calcExpression += v; document.getElementById('calcDisplay').textContent = calcExpression; }
        function calcOp(o) { calcExpression += ' ' + o + ' '; document.getElementById('calcDisplay').textContent = calcExpression; }
        function calcClear() { calcExpression = ''; document.getElementById('calcDisplay').textContent = '0'; }
        function calcBack() { calcExpression = calcExpression.slice(0, -1); document.getElementById('calcDisplay').textContent = calcExpression || '0'; }
        function calcEquals() { try { calcExpression = eval(calcExpression).toString(); document.getElementById('calcDisplay').textContent = calcExpression; } catch { document.getElementById('calcDisplay').textContent = 'Error'; setTimeout(calcClear, 1500); } }

        // Base64
        function encodeBase64() { document.getElementById('base64Output').textContent = btoa(document.getElementById('base64Input').value); }
        function decodeBase64() { try { document.getElementById('base64Output').textContent = atob(document.getElementById('base64Input').value); } catch { document.getElementById('base64Output').textContent = 'Invalid Base64'; } }

        // URL Tools
        function copyCurrentURL() { navigator.clipboard.writeText(window.location.href).then(() => alert('URL copied!')); }
        function openNewTab() { window.open('https://www.google.com', '_blank'); }
    </script>
</body>
</html>
