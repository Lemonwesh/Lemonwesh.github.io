<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lemons Proxy</title>
<link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçã</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root { 
  --blueprint-bg: #004494; 
  --blueprint-line: rgba(255, 255, 255, 0.85); 
  --accent: #FF6600; 
}
body { 
  background-color: var(--blueprint-bg); 
  background-image: linear-gradient(rgba(255,255,255,0.08) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px); 
  background-size: 20px 20px; 
  font-family: 'Courier Prime', monospace; 
  color: white; 
  min-height: 100vh; 
}
.settings-modal { 
  display: none; 
  position: fixed; 
  top: 0; left: 0; 
  width: 100%; height: 100%; 
  background: rgba(0, 10, 30, 0.95); 
  z-index: 3000; 
  padding: 40px; 
  overflow-y: auto; 
}
.settings-modal.active { display: block; }
.settings-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  border-bottom: 2px solid var(--blueprint-line); 
  padding-bottom: 20px; 
  margin-bottom: 30px; 
}
.settings-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 2rem; 
}
.close-settings { 
  background: #ff4444; 
  border: 2px solid #ff4444; 
  color: white; 
  padding: 10px 25px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
}
.setting-option { 
  background: rgba(0,0,0,0.4); 
  border: 2px solid var(--blueprint-line); 
  padding: 20px; 
  margin-bottom: 20px; 
  cursor: pointer; 
  transition: all 0.3s; 
  display: flex; 
  align-items: center; 
  gap: 20px; 
}
.setting-option:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.setting-icon { 
  width: 40px; height: 40px; 
  background: white; 
  border-radius: 5px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 1.5rem; 
}
header { 
  text-align: center; 
  padding: 30px 20px; 
  border-bottom: 4px double var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  position: relative; 
}
.blueprint-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 2.5rem; 
  text-transform: uppercase; 
  letter-spacing: 8px; 
  cursor: pointer; 
}
.credits { 
  position: absolute; 
  bottom: 10px; left: 50%; 
  transform: translateX(-50%); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.75rem; 
  opacity: 0.7; 
  color: rgba(255,255,255,0.8); 
  letter-spacing: 2px; 
}
.header-controls { 
  position: absolute; 
  top: 20px; right: 20px; 
  display: flex; gap: 15px; 
}
.control-btn { 
  background: rgba(255,255,255,0.1); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 8px 15px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.8rem; 
}
.control-btn:hover, .control-btn.active { 
  background: var(--accent); 
  border-color: var(--accent); 
}
nav { 
  background: rgba(0, 0, 0, 0.5); 
  border-bottom: 2px solid var(--blueprint-line); 
  padding: 15px; 
  display: flex; 
  justify-content: center; 
  gap: 15px; 
  flex-wrap: wrap; 
  position: sticky; 
  top: 0; z-index: 100; 
}
nav button { 
  background: transparent; 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 10px 20px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
  text-transform: uppercase; 
  font-size: 0.85rem; 
  transition: all 0.3s; 
}
nav button:hover, nav button.active { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.container { 
  max-width: 1400px; 
  margin: 30px auto; 
  padding: 0 20px; 
}
.section { display: none; }
.section.active { display: block; }
.search-box { 
  margin: 20px auto; 
  max-width: 600px; 
}
.search-input { 
  width: 100%; 
  padding: 12px; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  font-family: 'Courier Prime', monospace; 
  font-size: 1rem; 
}
.stats { 
  text-align: center; 
  padding: 20px; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  margin-bottom: 30px; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.2rem; 
}
.recent-section { 
  background: rgba(255,102,0,0.1); 
  border: 2px solid var(--accent); 
  padding: 20px; 
  margin-bottom: 30px; 
  display: none; 
}
.recent-section.active { display: block; }
.recent-grid { 
  display: flex; 
  gap: 10px; 
  flex-wrap: wrap; 
  margin-top: 15px; 
}
.recent-item { 
  background: rgba(0,0,0,0.4); 
  border: 1px solid var(--blueprint-line); 
  padding: 10px 15px; 
  cursor: pointer; 
  font-size: 0.85rem; 
  font-family: 'Share Tech Mono', monospace; 
  transition: all 0.2s; 
}
.recent-item:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.games-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); 
  gap: 20px; 
}
.game-card { 
  border: 2px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.3); 
  cursor: pointer; 
  transition: all 0.3s; 
  overflow: hidden; 
  display: flex; 
  flex-direction: column; 
  position: relative; 
}
.game-card:hover { 
  transform: translateY(-5px); 
  border-color: var(--accent); 
  box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
}
.game-emoji { 
  position: absolute; 
  top: 10px; right: 10px; 
  font-size: 1.5rem; 
  background: rgba(0,0,0,0.6); 
  border-radius: 50%; 
  width: 40px; height: 40px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border: 1px solid var(--blueprint-line); 
}
.game-tag { 
  position: absolute; 
  top: 10px; left: 10px; 
  background: var(--accent); 
  color: white; 
  padding: 4px 8px; 
  font-size: 0.7rem; 
  font-family: 'Share Tech Mono', monospace; 
  text-transform: uppercase; 
  border: 1px solid var(--blueprint-line); 
}
.game-thumb { 
  width: 100%; height: 140px; 
  background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%); 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border-bottom: 2px solid var(--blueprint-line); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.85rem; 
  color: var(--accent); 
  text-align: center; 
  padding: 10px; 
  text-transform: uppercase; 
}
.game-title { 
  padding: 12px; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.95rem; 
  flex: 1; 
}
.play-tag { 
  background: rgba(255,102,0,0.2); 
  color: var(--accent); 
  padding: 5px 10px; 
  font-size: 0.75rem; 
  text-align: center; 
  border-top: 1px solid var(--blueprint-line); 
  font-family: 'Share Tech Mono', monospace; 
}
.proxy-container { 
  border: 3px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  height: calc(100vh - 250px); 
  min-height: 600px; 
  display: flex; 
  flex-direction: column; 
}
.proxy-toolbar { 
  display: flex; 
  gap: 10px; 
  padding: 15px; 
  background: rgba(0, 0, 0, 0.5); 
  border-bottom: 2px solid var(--blueprint-line); 
  align-items: center; 
  flex-wrap: wrap; 
}
.proxy-nav-btn { 
  background: rgba(255,255,255,0.1); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 8px 15px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.85rem; 
  min-width: 40px; 
}
.proxy-nav-btn:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.proxy-omnibox { 
  flex: 2; 
  display: flex; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  min-width: 200px; 
}
.proxy-address { 
  flex: 1; 
  background: transparent; 
  border: none; 
  color: white; 
  padding: 10px; 
  font-family: 'Courier Prime', monospace; 
  font-size: 0.9rem; 
}
.proxy-address:focus { outline: none; }
.proxy-select { 
  flex: 1; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 10px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer;
  min-width: 180px;
}
.proxy-select option {
  background: #003d7a;
  color: white;
}
.proxy-go-btn { 
  background: var(--accent); 
  border: 2px solid var(--accent); 
  color: white; 
  padding: 10px 25px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-weight: bold; 
}
.proxy-go-btn:hover { background: transparent; }
.proxy-viewport { 
  flex: 1; 
  position: relative; 
  background: #001a33; 
  overflow: hidden; 
}
.proxy-frame { 
  width: 100%; 
  height: 100%; 
  border: none; 
  display: block;
  background: white;
}
.proxy-error { 
  position: absolute; 
  top: 0; left: 0; 
  width: 100%; height: 100%; 
  background: rgba(0,10,30,0.95); 
  display: none; 
  flex-direction: column; 
  justify-content: center; 
  align-items: center; 
  gap: 20px; 
  text-align: center; 
  padding: 40px; 
  z-index: 100;
}
.proxy-error.active { display: flex; }
.proxy-error h3 { 
  color: var(--accent); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.8rem; 
  margin-bottom: 10px; 
}
.proxy-error p { 
  max-width: 600px; 
  color: rgba(255,255,255,0.8); 
  line-height: 1.6; 
  margin-bottom: 20px; 
}
.proxy-error button { 
  padding: 12px 24px; 
  background: var(--accent); 
  border: 2px solid var(--accent); 
  color: white; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
  font-size: 1rem; 
}
.warning-box { 
  background: rgba(255,102,0,0.2); 
  border: 2px solid var(--accent); 
  padding: 15px; 
  margin-bottom: 20px; 
  font-family: 'Share Tech Mono'; 
  font-size: 0.85rem; 
  text-align: center; 
}
.game-viewer { 
  display: none; 
  position: fixed; 
  top: 0; left: 0; 
  width: 100vw; height: 100vh; 
  background: rgba(0, 10, 30, 0.98); 
  z-index: 2000; 
  padding: 20px; 
}
.game-viewer.active { display: block; }
.viewer-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin-bottom: 15px; 
  padding-bottom: 15px; 
  border-bottom: 2px solid var(--blueprint-line); 
}
.viewer-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.3rem; 
}
.game-frame { 
  width: 100%; 
  height: calc(100% - 80px); 
  border: 3px solid var(--blueprint-line); 
  background: white; 
}
.close-btn { 
  background: #ff4444; 
  border: 2px solid #ff4444; 
  color: white; 
  padding: 10px 25px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
}
.close-btn:hover { background: transparent; }
footer { 
  text-align: center; 
  padding: 30px; 
  border-top: 2px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  margin-top: 50px; 
  font-family: 'Share Tech Mono', monospace; 
}
.footer-credits { 
  font-size: 0.9rem; 
  color: rgba(255,255,255,0.9); 
  letter-spacing: 3px; 
}
.footer-credits span { 
  color: var(--accent); 
  font-weight: bold; 
}
</style>
</head>
<body>

<div class="settings-modal" id="settingsModal">
  <div class="settings-header">
    <h2 class="settings-title">‚öôÔ∏è TAB CLOAK SETTINGS</h2>
    <button class="close-settings" onclick="toggleSettings()">CLOSE</button>
  </div>
  <div class="setting-option" onclick="resetToLemons()">
    <div class="setting-icon">üçã</div>
    <div>
      <div style="font-weight: bold;">Reset to Lemons Proxy</div>
      <div style="font-size: 0.85rem; opacity: 0.8;">Restore original title and lemon icon</div>
    </div>
  </div>
  <div class="setting-option" onclick="cloakTab('Google Classroom', 'https://ssl.gstatic.com/classroom/ic_product_classroom_32.png')">
    <div class="setting-icon">üìö</div>
    <div><div style="font-weight: bold;">Google Classroom</div></div>
  </div>
  <div class="setting-option" onclick="cloakTab('Canvas', 'https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico')">
    <div class="setting-icon">üéì</div>
    <div><div style="font-weight: bold;">Canvas</div></div>
  </div>
  <div class="setting-option" onclick="cloakTab('Google Drive', 'https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png')">
    <div class="setting-icon">üìÅ</div>
    <div><div style="font-weight: bold;">Google Drive</div></div>
  </div>
</div>

<header>
  <div class="header-controls">
    <button class="control-btn" onclick="toggleSettings()">‚öôÔ∏è SETTINGS</button>
  </div>
  <h1 class="blueprint-title" onclick="showSection('games')">üçã LEMONS PROXY</h1>
  <p style="margin-top: 10px; font-family: 'Share Tech Mono'; font-size: 0.9rem;">VERIFIED GAMES ‚Ä¢ SEARCH ENGINE PORTAL</p>
  <div class="credits">CODE BY <span>LEMONWESH</span> // DESIGN BY <span>LD</span></div>
</header>

<nav>
  <button class="nav-btn active" onclick="showSection('games')" id="nav-games">[ GAMES ]</button>
  <button class="nav-btn" onclick="showSection('proxy')" id="nav-proxy">[ SEARCH ]</button>
</nav>

<div class="container">

  <section id="proxy" class="section">
    <div class="warning-box">
      üîç SELECT A SEARCH ENGINE & TYPE QUERY, OR LEAVE BLANK TO VISIT HOMEPAGE. IF BLOCKED, AUTO-OPENS IN NEW TAB.
    </div>
    <div class="proxy-container">
      <div class="proxy-toolbar">
        <button class="proxy-nav-btn" onclick="reloadProxy()" title="Reload">‚Üª</button>
        
        <div class="proxy-omnibox">
          <input type="text" class="proxy-address" id="searchQuery" placeholder="Search query or leave blank for homepage..." onkeydown="if(event.key === 'Enter') searchWeb()">
        </div>
        
        <select class="proxy-select" id="searchEngine">
          <option value="duckduckgo">üîç DuckDuckGo</option>
          <option value="brave">ü¶Å Brave Search</option>
          <option value="startpage">üõ°Ô∏è Startpage</option>
          <option value="metager">üåø MetaGer</option>
          <option value="mojeek">üï∏Ô∏è Mojeek</option>
          <option value="bing">üîµ Bing</option>
          <option value="ecosia">üå≥ Ecosia</option>
          <option value="yahoo">üü£ Yahoo</option>
          <option value="wolfram">üßÆ WolframAlpha</option>
          <option value="jina">üìñ Text Reader (Jina)</option>
        </select>
        
        <button class="proxy-go-btn" onclick="searchWeb()">SEARCH</button>
      </div>

      <div class="proxy-viewport">
        <iframe id="proxyFrame" class="proxy-frame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups" allow="fullscreen"></iframe>
        
        <div id="proxyError" class="proxy-error">
          <h3>üîí IFRAME BLOCKED</h3>
          <p>This search engine blocks embedding for security.</p>
          <p style="color: var(--accent);">Opened in new tab automatically!</p>
          <button onclick="hideProxyError()">CLOSE MESSAGE</button>
        </div>
      </div>
    </div>
  </section>

  <section id="games" class="section active">
    <div class="search-box">
      <input type="text" class="search-input" id="searchInput" placeholder="üîç Search all games..." onkeyup="searchGames()">
    </div>
    
    <div class="recent-section" id="recentSection">
      <div class="recent-title">üìå RECENTLY PLAYED</div>
      <div class="recent-grid" id="recentGrid"></div>
    </div>
    
    <div class="stats">
      <span id="gameCount">0</span> WORKING GAMES ‚Ä¢ CLICK ANY TO PLAY
    </div>
    
    <div class="games-grid" id="gamesGrid"></div>
  </section>

</div>

<footer>
  <div class="footer-credits">
    CODE BY <span>LEMONWESH</span> // DESIGN BY <span>LD</span>
  </div>
</footer>

<div class="game-viewer" id="gameViewer">
  <div class="viewer-header">
    <h2 id="viewerTitle" class="viewer-title">üéÆ Game</h2>
    <button class="close-btn" onclick="closeGame()">‚úï CLOSE</button>
  </div>
  <iframe id="gameFrame" class="game-frame" allowfullscreen sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-pointer-lock"></iframe>
</div>

<script>
// GAMES LIBRARY
const games = [
  {name: "8 Ball Pool", emoji: "üé±", tag: "SPORTS", url: "https://html5.gamedistribution.com/ed65e4198fe74fdbb0b2ac015dd81128/"},
  {name: "Ludo With Friends", emoji: "üé≤", tag: "MULTIPLAYER", url: "https://zv1y2i8p.play.gamezop.com/g/SkhljT2fdgb"},
  {name: "Basketball Stars", emoji: "üèÄ", tag: "MULTIPLAYER", url: "https://html5.gamedistribution.com/f7c4e66b484e45df86b7d46450aac477/"},
  {name: "Poly Track", emoji: "üèéÔ∏è", tag: "RACING", url: "https://d3rtzzzsiu7gdr.cloudfront.net/files/polytrack/index.html"},
  {name: "Jelly Truck", emoji: "üöö", tag: "RACING", url: "https://jellytruck2.github.io/"},
  {name: "Slope", emoji: "üìê", tag: "RACING", url: "https://slope-y8.com/"},
  {name: "Slope 2", emoji: "üìê2", tag: "RACING", url: "https://slopegame2.github.io/"},
  {name: "Drift Hunters", emoji: "üèéÔ∏è", tag: "RACING", url: "https://drifthuntersonline.github.io/"},
  {name: "Slow Roads", emoji: "üõ£Ô∏è", tag: "RACING", url: "https://slowroads.io/"},
  {name: "Subway Surfers", emoji: "üèÉ", tag: "ARCADE", url: "https://subwaysurfers76.github.io/"},
  {name: "Temple Run 2", emoji: "üèõÔ∏è", tag: "ARCADE", url: "https://run3temp.github.io/"},
  {name: "Crossy Road", emoji: "üêî", tag: "ARCADE", url: "https://crossyroad66.github.io/"},
  {name: "1v1.LOL", emoji: "üî´", tag: "IO GAME", url: "https://1v1lol-gg.github.io/"},
  {name: "Shell Shockers", emoji: "ü•ö", tag: "IO GAME", url: "https://shellshock.io/"},
  {name: "Krunker.io", emoji: "üî´", tag: "IO GAME", url: "https://krunker.io/"},
  {name: "Slither.io", emoji: "üêç", tag: "IO GAME", url: "https://slither.io/"},
  {name: "Agar.io", emoji: "‚ö™", tag: "IO GAME", url: "https://agar.io/"},
  {name: "Smash Karts", emoji: "üèéÔ∏è", tag: "IO GAME", url: "https://smashkarts.io/"},
  {name: "Zombs Royale", emoji: "üßü", tag: "IO GAME", url: "https://zombsroyale.io/"},
  {name: "Retro Bowl", emoji: "üèà", tag: "SPORTS", url: "https://retrobowl97.github.io/"},
  {name: "Thumb Fighter", emoji: "üëä", tag: "FIGHTING", url: "https://thumbfighter.github.io/"},
  {name: "Rooftop Snipers", emoji: "üéØ", tag: "FIGHTING", url: "https://rooftopsnipers.github.io/"},
  {name: "2048", emoji: "üî¢", tag: "PUZZLE", url: "https://play2048.co/"},
  {name: "Cookie Clicker", emoji: "üç™", tag: "PUZZLE", url: "https://cookieclicker-game.github.io/"},
  {name: "Minesweeper", emoji: "üí£", tag: "PUZZLE", url: "https://minesweeper.online/"},
  {name: "Little Alchemy 2", emoji: "‚öóÔ∏è", tag: "PUZZLE", url: "https://littlealchemy2.com/"},
  {name: "Sudoku Classic", emoji: "üß©", tag: "PUZZLE", url: "https://zv1y2i8p.play.gamezop.com/g/rkHVpV2Yugb"},
  {name: "Fleeing the Complex", emoji: "üèÉ", tag: "HENRY", url: "https://machita66.github.io/game/fleeingthecomplex.html"},
  {name: "Escaping the Prison", emoji: "üî®", tag: "HENRY", url: "https://escaping-the-prison.com/"},
  {name: "Stealing the Diamond", emoji: "üíé", tag: "HENRY", url: "https://stealing-the-diamond.com/"},
  {name: "Infiltrating the Airship", emoji: "üéà", tag: "HENRY", url: "https://infiltrating-the-airship.com/"},
  {name: "Papa's Pizzeria", emoji: "üçï", tag: "PAPA'S", url: "https://papaspizzeria-unblocked.github.io/"},
  {name: "Papa's Pancakeria", emoji: "ü•û", tag: "PAPA'S", url: "https://papaspancakeria.github.io/"},
  {name: "Geometry Dash", emoji: "üî∑", tag: "PLATFORMER", url: "https://geometry-dash-unbanned.github.io/"},
  {name: "OvO", emoji: "ü•ö", tag: "PLATFORMER", url: "https://dedragames.com/games/ovo/1.3/"},
  {name: "Vex 5", emoji: "üî∫", tag: "PLATFORMER", url: "https://vex5.com/"},
  {name: "Vex 6", emoji: "üî∫6", tag: "PLATFORMER", url: "https://vex6.com/"},
  {name: "Big Tower Tiny Square", emoji: "üóº", tag: "PLATFORMER", url: "https://big-tower-tiny-square.com/"},
  {name: "Pac-Man", emoji: "üëª", tag: "ARCADE", url: "https://google-pacman.github.io/"},
  {name: "Chrome Dino", emoji: "ü¶ñ", tag: "ARCADE", url: "https://chrome-dino-game.github.io/"},
  {name: "Flappy Bird", emoji: "üê¶", tag: "ARCADE", url: "https://flappy-bird.com/"},
  {name: "Eaglercraft 1.8.8", emoji: "‚õèÔ∏è", tag: "MINECRAFT", url: "https://g.deev.is/eaglercraft/"},
  {name: "MineKhan", emoji: "‚õèÔ∏è", tag: "MINECRAFT", url: "https://yikuansun.github.io/minekhan/"},
  {name: "Voxel Builder", emoji: "üßä", tag: "MINECRAFT", url: "https://voxelbuilder.github.io/"}
];

// SEARCH ENGINES CONFIG
const searchEngines = {
  duckduckgo: { 
    name: "DuckDuckGo", 
    home: "https://duckduckgo.com/",
    search: "https://duckduckgo.com/?q="
  },
  brave: { 
    name: "Brave Search", 
    home: "https://search.brave.com/",
    search: "https://search.brave.com/search?q="
  },
  startpage: { 
    name: "Startpage", 
    home: "https://www.startpage.com/",
    search: "https://www.startpage.com/do/dsearch?query="
  },
  metager: { 
    name: "MetaGer", 
    home: "https://metager.org/",
    search: "https://metager.org/meta/meta.ger3?eingabe="
  },
  mojeek: { 
    name: "Mojeek", 
    home: "https://www.mojeek.com/",
    search: "https://www.mojeek.com/search?q="
  },
  bing: { 
    name: "Bing", 
    home: "https://www.bing.com/",
    search: "https://www.bing.com/search?q="
  },
  ecosia: { 
    name: "Ecosia", 
    home: "https://www.ecosia.org/",
    search: "https://www.ecosia.org/search?q="
  },
  yahoo: { 
    name: "Yahoo", 
    home: "https://www.yahoo.com/",
    search: "https://search.yahoo.com/search?p="
  },
  wolfram: { 
    name: "WolframAlpha", 
    home: "https://www.wolframalpha.com/",
    search: "https://www.wolframalpha.com/input?i="
  },
  jina: { 
    name: "Text Reader", 
    home: "https://r.jina.ai/http://example.com",
    search: "https://r.jina.ai/http://",
    isText: true
  }
};

let currentSearchUrl = '';

function searchWeb() {
  const engine = document.getElementById('searchEngine').value;
  const query = document.getElementById('searchQuery').value.trim();
  const frame = document.getElementById('proxyFrame');
  const errorDiv = document.getElementById('proxyError');
  
  errorDiv.classList.remove('active');
  
  const config = searchEngines[engine];
  let url;
  
  if (query) {
    if (config.isText) {
      // For text reader, check if URL or search
      if (query.includes('.') && !query.includes(' ')) {
        url = config.search + query;
      } else {
        url = config.search + "google.com/search?q=" + encodeURIComponent(query);
      }
    } else {
      url = config.search + encodeURIComponent(query);
    }
  } else {
    url = config.home;
  }
  
  currentSearchUrl = url;
  
  // Try iframe first
  frame.src = url;
  
  // Check if blocked after 3 seconds
  setTimeout(() => {
    try {
      // If we can't access it but it's not about:blank, it loaded (cross-origin success)
      if (frame.contentWindow.location.href === 'about:blank' && frame.src !== 'about:blank') {
        // It blocked
        throw new Error('Blocked');
      }
    } catch (e) {
      // Cross-origin error or blocked - open in new tab
      window.open(url, '_blank');
      errorDiv.classList.add('active');
      frame.src = '';
    }
  }, 3000);
}

function reloadProxy() {
  const frame = document.getElementById('proxyFrame');
  if (currentSearchUrl) {
    frame.src = currentSearchUrl;
  }
}

function hideProxyError() {
  document.getElementById('proxyError').classList.remove('active');
}

// GAME FUNCTIONS
function init() {
  document.getElementById('gameCount').textContent = games.length;
  renderGames(games);
  loadRecentGames();
  
  const savedTitle = localStorage.getItem('cloakTitle');
  const savedIcon = localStorage.getItem('cloakIcon');
  if (savedTitle) document.title = savedTitle;
  if (savedIcon) document.getElementById('favicon').href = savedIcon;
}

function renderGames(gameList) {
  const grid = document.getElementById('gamesGrid');
  grid.innerHTML = gameList.map(game => `
    <div class="game-card" onclick="playGame('${game.name}', '${game.url}')">
      ${game.tag ? `<span class="game-tag">${game.tag}</span>` : ''}
      <span class="game-emoji">${game.emoji}</span>
      <div class="game-thumb">${game.name}</div>
      <div class="game-title">${game.name}</div>
      <div class="play-tag">CLICK TO PLAY</div>
    </div>
  `).join('');
}

function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.getElementById('nav-' + id)?.classList.add('active');
}

function playGame(name, url) {
  let recent = JSON.parse(localStorage.getItem('recentGames') || '[]');
  recent = recent.filter(g => g.name !== name);
  recent.unshift({name, url});
  recent = recent.slice(0, 8);
  localStorage.setItem('recentGames', JSON.stringify(recent));
  
  document.getElementById('gameViewer').classList.add('active');
  document.getElementById('viewerTitle').textContent = 'üéÆ ' + name;
  document.getElementById('gameFrame').src = url;
  loadRecentGames();
}

function loadRecentGames() {
  const recent = JSON.parse(localStorage.getItem('recentGames') || '[]');
  const section = document.getElementById('recentSection');
  const grid = document.getElementById('recentGrid');
  
  if (recent.length === 0) {
    section.classList.remove('active');
    return;
  }
  
  section.classList.add('active');
  grid.innerHTML = recent.map(g => `
    <div class="recent-item" onclick="playGame('${g.name}', '${g.url}')">${g.name}</div>
  `).join('');
}

function closeGame() {
  document.getElementById('gameViewer').classList.remove('active');
  document.getElementById('gameFrame').src = '';
}

function searchGames() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  const filtered = games.filter(g => g.name.toLowerCase().includes(query));
  renderGames(filtered);
}

// SETTINGS
function toggleSettings() {
  document.getElementById('settingsModal').classList.toggle('active');
}

function resetToLemons() {
  document.title = 'Lemons Proxy';
  document.getElementById('favicon').href = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçã</text></svg>';
  localStorage.removeItem('cloakTitle');
  localStorage.removeItem('cloakIcon');
}

function cloakTab(title, iconUrl) {
  document.title = title;
  document.getElementById('favicon').href = iconUrl;
  localStorage.setItem('cloakTitle', title);
  localStorage.setItem('cloakIcon', iconUrl);
}

document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    if (document.getElementById('settingsModal').classList.contains('active')) toggleSettings();
    else if (document.getElementById('gameViewer').classList.contains('active')) closeGame();
  }
});

window.onload = init;
</script>
</body>
</html>
