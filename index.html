<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lemons Proxy</title>
<link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçã</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root { 
  --blueprint-bg: #004494; 
  --blueprint-line: rgba(255, 255, 255, 0.85); 
  --accent: #FF6600; 
  --warning: #ff4444;
}
body { 
  background-color: var(--blueprint-bg); 
  background-image: linear-gradient(rgba(255,255,255,0.08) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px); 
  background-size: 20px 20px; 
  font-family: 'Courier Prime', monospace; 
  color: white; 
  min-height: 100vh; 
}
.settings-modal { 
  display: none; 
  position: fixed; 
  top: 0; left: 0; 
  width: 100%; height: 100%; 
  background: rgba(0, 10, 30, 0.95); 
  z-index: 3000; 
  padding: 40px; 
  overflow-y: auto; 
}
.settings-modal.active { display: block; }
.settings-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  border-bottom: 2px solid var(--blueprint-line); 
  padding-bottom: 20px; 
  margin-bottom: 30px; 
}
.settings-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 2rem; 
}
.close-settings { 
  background: #ff4444; 
  border: 2px solid #ff4444; 
  color: white; 
  padding: 10px 25px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
}
.setting-option { 
  background: rgba(0,0,0,0.4); 
  border: 2px solid var(--blueprint-line); 
  padding: 20px; 
  margin-bottom: 20px; 
  cursor: pointer; 
  transition: all 0.3s; 
  display: flex; 
  align-items: center; 
  gap: 20px; 
}
.setting-option:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.setting-icon { 
  width: 40px; height: 40px; 
  background: white; 
  border-radius: 5px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 1.5rem; 
}
header { 
  text-align: center; 
  padding: 30px 20px; 
  border-bottom: 4px double var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  position: relative; 
}
.blueprint-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 2.5rem; 
  text-transform: uppercase; 
  letter-spacing: 8px; 
  cursor: pointer; 
}
.credits { 
  position: absolute; 
  bottom: 10px; left: 50%; 
  transform: translateX(-50%); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.75rem; 
  opacity: 0.7; 
  color: rgba(255,255,255,0.8); 
  letter-spacing: 2px; 
}
.header-controls { 
  position: absolute; 
  top: 20px; right: 20px; 
  display: flex; gap: 15px; 
}
.control-btn { 
  background: rgba(255,255,255,0.1); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 8px 15px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.8rem; 
}
.control-btn:hover, .control-btn.active { 
  background: var(--accent); 
  border-color: var(--accent); 
}
nav { 
  background: rgba(0, 0, 0, 0.5); 
  border-bottom: 2px solid var(--blueprint-line); 
  padding: 15px; 
  display: flex; 
  justify-content: center; 
  gap: 15px; 
  flex-wrap: wrap; 
  position: sticky; 
  top: 0; z-index: 100; 
}
nav button { 
  background: transparent; 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 10px 20px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
  text-transform: uppercase; 
  font-size: 0.85rem; 
  transition: all 0.3s; 
}
nav button:hover, nav button.active { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.container { 
  max-width: 1400px; 
  margin: 30px auto; 
  padding: 0 20px; 
}
.section { display: none; }
.section.active { display: block; }
.search-box { 
  margin: 20px auto; 
  max-width: 600px; 
}
.search-input { 
  width: 100%; 
  padding: 12px; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  font-family: 'Courier Prime', monospace; 
  font-size: 1rem; 
}
.stats { 
  text-align: center; 
  padding: 20px; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  margin-bottom: 30px; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.2rem; 
}
.recent-section { 
  background: rgba(255,102,0,0.1); 
  border: 2px solid var(--accent); 
  padding: 20px; 
  margin-bottom: 30px; 
  display: none; 
}
.recent-section.active { display: block; }
.recent-grid { 
  display: flex; 
  gap: 10px; 
  flex-wrap: wrap; 
  margin-top: 15px; 
}
.recent-item { 
  background: rgba(0,0,0,0.4); 
  border: 1px solid var(--blueprint-line); 
  padding: 10px 15px; 
  cursor: pointer; 
  font-size: 0.85rem; 
  font-family: 'Share Tech Mono', monospace; 
  transition: all 0.2s; 
}
.recent-item:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.games-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); 
  gap: 20px; 
}
.game-card { 
  border: 2px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.3); 
  cursor: pointer; 
  transition: all 0.3s; 
  overflow: hidden; 
  display: flex; 
  flex-direction: column; 
  position: relative; 
}
.game-card:hover { 
  transform: translateY(-5px); 
  border-color: var(--accent); 
  box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
}
.game-emoji { 
  position: absolute; 
  top: 10px; right: 10px; 
  font-size: 1.5rem; 
  background: rgba(0,0,0,0.6); 
  border-radius: 50%; 
  width: 40px; height: 40px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border: 1px solid var(--blueprint-line); 
}
.game-tag { 
  position: absolute; 
  top: 10px; left: 10px; 
  background: var(--accent); 
  color: white; 
  padding: 4px 8px; 
  font-size: 0.7rem; 
  font-family: 'Share Tech Mono', monospace; 
  text-transform: uppercase; 
  border: 1px solid var(--blueprint-line); 
}
.game-thumb { 
  width: 100%; height: 140px; 
  background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%); 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border-bottom: 2px solid var(--blueprint-line); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.85rem; 
  color: var(--accent); 
  text-align: center; 
  padding: 10px; 
  text-transform: uppercase; 
}
.game-title { 
  padding: 12px; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.95rem; 
  flex: 1; 
}
.play-tag { 
  background: rgba(255,102,0,0.2); 
  color: var(--accent); 
  padding: 5px 10px; 
  font-size: 0.75rem; 
  text-align: center; 
  border-top: 1px solid var(--blueprint-line); 
  font-family: 'Share Tech Mono', monospace; 
}
/* Proxy Browser Styles */
.proxy-container { 
  border: 3px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  height: calc(100vh - 250px); 
  min-height: 600px; 
  display: flex; 
  flex-direction: column; 
}
.proxy-toolbar { 
  display: flex; 
  gap: 10px; 
  padding: 15px; 
  background: rgba(0, 0, 0, 0.5); 
  border-bottom: 2px solid var(--blueprint-line); 
  align-items: center; 
  flex-wrap: wrap; 
}
.proxy-nav-btn { 
  background: rgba(255,255,255,0.1); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 8px 15px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 0.85rem; 
  min-width: 40px; 
}
.proxy-nav-btn:hover { 
  background: var(--accent); 
  border-color: var(--accent); 
}
.proxy-omnibox { 
  flex: 1; 
  display: flex; 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  min-width: 200px; 
}
.proxy-address { 
  flex: 1; 
  background: transparent; 
  border: none; 
  color: white; 
  padding: 10px; 
  font-family: 'Courier Prime', monospace; 
  font-size: 0.9rem; 
}
.proxy-address:focus { outline: none; }
.proxy-go-btn { 
  background: var(--accent); 
  border: 2px solid var(--accent); 
  color: white; 
  padding: 8px 20px; 
  cursor: pointer; 
  font-family: 'Share Tech Mono', monospace; 
  font-weight: bold; 
}
.proxy-go-btn:hover { background: transparent; }
.proxy-select { 
  background: rgba(0,0,0,0.3); 
  border: 2px solid var(--blueprint-line); 
  color: white; 
  padding: 8px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer;
}
.proxy-select option {
  background: #003d7a;
  color: white;
}
.proxy-viewport { 
  flex: 1; 
  position: relative; 
  background: white; 
  overflow: hidden; 
}
.proxy-frame { 
  width: 100%; 
  height: 100%; 
  border: none; 
  display: block; 
}
.proxy-error { 
  position: absolute; 
  top: 0; left: 0; 
  width: 100%; height: 100%; 
  background: rgba(0,10,30,0.95); 
  display: none; 
  flex-direction: column; 
  justify-content: center; 
  align-items: center; 
  gap: 20px; 
  text-align: center; 
  padding: 40px; 
}
.proxy-error.active { display: flex; }
.proxy-error h3 { 
  color: var(--accent); 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.8rem; 
  margin-bottom: 10px; 
}
.proxy-error p { 
  max-width: 600px; 
  color: rgba(255,255,255,0.8); 
  line-height: 1.6; 
  margin-bottom: 20px; 
}
.proxy-error button { 
  padding: 12px 24px; 
  background: var(--accent); 
  border: 2px solid var(--accent); 
  color: white; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
  font-size: 1rem; 
}
.proxy-error button.alt { 
  background: transparent; 
  border-color: var(--blueprint-line); 
}
.proxy-status { 
  position: absolute; 
  bottom: 10px; right: 10px; 
  background: rgba(0,0,0,0.8); 
  padding: 5px 10px; 
  font-size: 0.75rem; 
  font-family: 'Share Tech Mono', monospace; 
  border: 1px solid var(--blueprint-line); 
  z-index: 10; 
}
.warning-box { 
  background: rgba(255,0,0,0.1); 
  border: 2px solid rgba(255,0,0,0.3); 
  padding: 15px; 
  margin-bottom: 20px; 
  font-family: 'Share Tech Mono'; 
  font-size: 0.9rem; 
  text-align: center; 
}
.game-viewer { 
  display: none; 
  position: fixed; 
  top: 0; left: 0; 
  width: 100vw; height: 100vh; 
  background: rgba(0, 10, 30, 0.98); 
  z-index: 2000; 
  padding: 20px; 
}
.game-viewer.active { display: block; }
.viewer-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin-bottom: 15px; 
  padding-bottom: 15px; 
  border-bottom: 2px solid var(--blueprint-line); 
}
.viewer-title { 
  font-family: 'Share Tech Mono', monospace; 
  font-size: 1.3rem; 
}
.game-frame { 
  width: 100%; 
  height: calc(100% - 80px); 
  border: 3px solid var(--blueprint-line); 
  background: white; 
}
.close-btn { 
  background: #ff4444; 
  border: 2px solid #ff4444; 
  color: white; 
  padding: 10px 25px; 
  font-family: 'Share Tech Mono', monospace; 
  cursor: pointer; 
}
.close-btn:hover { background: transparent; }
footer { 
  text-align: center; 
  padding: 30px; 
  border-top: 2px solid var(--blueprint-line); 
  background: rgba(0, 0, 0, 0.4); 
  margin-top: 50px; 
  font-family: 'Share Tech Mono', monospace; 
}
.footer-credits { 
  font-size: 0.9rem; 
  color: rgba(255,255,255,0.9); 
  letter-spacing: 3px; 
}
.footer-credits span { 
  color: var(--accent); 
  font-weight: bold; 
}
</style>
</head>
<body>

<!-- Settings Modal -->
<div class="settings-modal" id="settingsModal">
  <div class="settings-header">
    <h2 class="settings-title">‚öôÔ∏è TAB CLOAK SETTINGS</h2>
    <button class="close-settings" onclick="toggleSettings()">CLOSE</button>
  </div>
  <div class="setting-option" onclick="resetToLemons()">
    <div class="setting-icon">üçã</div>
    <div>
      <div style="font-weight: bold;">Reset to Lemons Proxy</div>
      <div style="font-size: 0.85rem; opacity: 0.8;">Restore original title and lemon icon</div>
    </div>
  </div>
  <div class="setting-option" onclick="cloakTab('Google Classroom', 'https://ssl.gstatic.com/classroom/ic_product_classroom_32.png')">
    <div class="setting-icon">üìö</div>
    <div><div style="font-weight: bold;">Google Classroom</div></div>
  </div>
  <div class="setting-option" onclick="cloakTab('Canvas', 'https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico')">
    <div class="setting-icon">üéì</div>
    <div><div style="font-weight: bold;">Canvas</div></div>
  </div>
  <div class="setting-option" onclick="cloakTab('Google Drive', 'https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png')">
    <div class="setting-icon">üìÅ</div>
    <div><div style="font-weight: bold;">Google Drive</div></div>
  </div>
</div>

<!-- Header -->
<header>
  <div class="header-controls">
    <button class="control-btn" onclick="toggleSettings()">‚öôÔ∏è SETTINGS</button>
  </div>
  <h1 class="blueprint-title" onclick="showSection('games')">üçã LEMONS PROXY</h1>
  <p style="margin-top: 10px; font-family: 'Share Tech Mono'; font-size: 0.9rem;">VERIFIED WORKING GAMES ‚Ä¢ EMBEDDED PROXY BROWSER</p>
  <div class="credits">CODE BY <span>LEMONWESH</span> // DESIGN BY <span>LD</span></div>
</header>

<!-- Navigation -->
<nav>
  <button class="nav-btn active" onclick="showSection('games')" id="nav-games">[ GAMES ]</button>
  <button class="nav-btn" onclick="showSection('proxy')" id="nav-proxy">[ PROXY ]</button>
</nav>

<!-- Main Container -->
<div class="container">

  <!-- PROXY SECTION -->
  <section id="proxy" class="section">
    <div class="warning-box">
      ‚ö†Ô∏è PROXY NOTICE: Select an engine from the dropdown below. Most modern sites block iframes - use üåê Google Translate for best results or try alternative engines.
    </div>
    <div class="proxy-container">
      <!-- Toolbar -->
      <div class="proxy-toolbar">
        <button class="proxy-nav-btn" onclick="proxyBack()" title="Back">‚Üê</button>
        <button class="proxy-nav-btn" onclick="proxyForward()" title="Forward">‚Üí</button>
        <button class="proxy-nav-btn" onclick="reloadProxy()" title="Reload">‚Üª</button>
        
        <div class="proxy-omnibox">
          <input type="text" class="proxy-address" id="proxyAddress" placeholder="https://example.com or search..." onkeydown="if(event.key === 'Enter') navigateProxy()">
        </div>
        
        <select class="proxy-select" id="proxyEngine">
          <option value="translate" selected>üåê Google Translate</option>
          <option value="croxy">üü¢ CroxyProxy</option>
          <option value="proxysite">üîµ ProxySite</option>
          <option value="kproxy">üõ°Ô∏è KProxy</option>
          <option value="filterbypass">üîì FilterBypass</option>
          <option value="anonymouse">üë§ Anonymouse</option>
          <option value="unblocker">üîë Unblocker</option>
          <option value="textise">üìñ Text Mode</option>
          <option value="direct">üéØ Direct</option>
        </select>
        
        <button class="proxy-go-btn" onclick="navigateProxy()">GO</button>
      </div>

      <!-- Viewport -->
      <div class="proxy-viewport">
        <iframe id="proxyFrame" class="proxy-frame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-pointer-lock allow-downloads" allow="fullscreen; autoplay; clipboard-read; clipboard-write"></iframe>
        
        <div id="proxyError" class="proxy-error">
          <h3>‚ö†Ô∏è SITE BLOCKED EMBEDDING</h3>
          <p>This website has <strong>X-Frame-Options</strong> or <strong>Content Security Policy</strong> headers that prevent it from loading inside an iframe.</p>
          <p style="font-size: 0.9rem; color: var(--accent);">Try a different proxy engine from the dropdown above, or use the buttons below:</p>
          <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
            <button onclick="openInNewTab()">üîì OPEN IN NEW TAB</button>
            <button onclick="tryTextMode()" class="alt">üìñ TRY TEXT MODE</button>
            <button onclick="hideProxyError()" class="alt">CLOSE MESSAGE</button>
          </div>
        </div>
        
        <div class="proxy-status" id="proxyStatus">Ready</div>
      </div>
    </div>
  </section>

  <!-- GAMES SECTION -->
  <section id="games" class="section active">
    <div class="search-box">
      <input type="text" class="search-input" id="searchInput" placeholder="üîç Search all games..." onkeyup="searchGames()">
    </div>
    
    <div class="recent-section" id="recentSection">
      <div class="recent-title">üìå RECENTLY PLAYED</div>
      <div class="recent-grid" id="recentGrid"></div>
    </div>
    
    <div class="stats">
      <span id="gameCount">0</span> WORKING GAMES ‚Ä¢ CLICK ANY TO PLAY
    </div>
    
    <div class="games-grid" id="gamesGrid"></div>
  </section>

</div>

<footer>
  <div class="footer-credits">
    CODE BY <span>LEMONWESH</span> // DESIGN BY <span>LD</span>
  </div>
</footer>

<!-- Game Viewer -->
<div class="game-viewer" id="gameViewer">
  <div class="viewer-header">
    <h2 id="viewerTitle" class="viewer-title">üéÆ Game</h2>
    <button class="close-btn" onclick="closeGame()">‚úï CLOSE</button>
  </div>
  <iframe id="gameFrame" class="game-frame" allowfullscreen sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-pointer-lock"></iframe>
</div>

<script>
// ===========================
// GAME LIBRARY (40+ GAMES)
// ===========================
const games = [
  {name: "8 Ball Pool", emoji: "üé±", tag: "SPORTS", url: "https://html5.gamedistribution.com/ed65e4198fe74fdbb0b2ac015dd81128/"},
  {name: "Ludo With Friends", emoji: "üé≤", tag: "MULTIPLAYER", url: "https://zv1y2i8p.play.gamezop.com/g/SkhljT2fdgb"},
  {name: "Basketball Stars", emoji: "üèÄ", tag: "MULTIPLAYER", url: "https://html5.gamedistribution.com/f7c4e66b484e45df86b7d46450aac477/"},
  {name: "Stick Fighter", emoji: "‚öîÔ∏è", tag: "MULTIPLAYER", url: "https://html5.gamedistribution.com/rgSkqGbJade4O68B0T2u3zCZqe0FMBqO/"},
  {name: "Poly Track", emoji: "üèéÔ∏è", tag: "RACING", url: "https://d3rtzzzsiu7gdr.cloudfront.net/files/polytrack/index.html"},
  {name: "Jelly Truck", emoji: "üöö", tag: "RACING", url: "https://jellytruck2.github.io/"},
  {name: "Slope", emoji: "üìê", tag: "RACING", url: "https://slope-y8.com/"},
  {name: "Slope 2", emoji: "üìê2", tag: "RACING", url: "https://slopegame2.github.io/"},
  {name: "Drift Hunters", emoji: "üèéÔ∏è", tag: "RACING", url: "https://drifthuntersonline.github.io/"},
  {name: "Slow Roads", emoji: "üõ£Ô∏è", tag: "RACING", url: "https://slowroads.io/"},
  {name: "Subway Surfers", emoji: "üèÉ", tag: "ARCADE", url: "https://subwaysurfers76.github.io/"},
  {name: "Temple Run 2", emoji: "üèõÔ∏è", tag: "ARCADE", url: "https://run3temp.github.io/"},
  {name: "Crossy Road", emoji: "üêî", tag: "ARCADE", url: "https://crossyroad66.github.io/"},
  {name: "1v1.LOL", emoji: "üî´", tag: "IO GAME", url: "https://1v1lol-gg.github.io/"},
  {name: "Shell Shockers", emoji: "ü•ö", tag: "IO GAME", url: "https://shellshock.io/"},
  {name: "Krunker.io", emoji: "üî´", tag: "IO GAME", url: "https://krunker.io/"},
  {name: "Slither.io", emoji: "üêç", tag: "IO GAME", url: "https://slither.io/"},
  {name: "Agar.io", emoji: "‚ö™", tag: "IO GAME", url: "https://agar.io/"},
  {name: "Smash Karts", emoji: "üèéÔ∏è", tag: "IO GAME", url: "https://smashkarts.io/"},
  {name: "Zombs Royale", emoji: "üßü", tag: "IO GAME", url: "https://zombsroyale.io/"},
  {name: "Retro Bowl", emoji: "üèà", tag: "SPORTS", url: "https://retrobowl97.github.io/"},
  {name: "Thumb Fighter", emoji: "üëä", tag: "FIGHTING", url: "https://thumbfighter.github.io/"},
  {name: "Rooftop Snipers", emoji: "üéØ", tag: "FIGHTING", url: "https://rooftopsnipers.github.io/"},
  {name: "2048", emoji: "üî¢", tag: "PUZZLE", url: "https://play2048.co/"},
  {name: "Cookie Clicker", emoji: "üç™", tag: "PUZZLE", url: "https://cookieclicker-game.github.io/"},
  {name: "Minesweeper", emoji: "üí£", tag: "PUZZLE", url: "https://minesweeper.online/"},
  {name: "Little Alchemy 2", emoji: "‚öóÔ∏è", tag: "PUZZLE", url: "https://littlealchemy2.com/"},
  {name: "Sudoku Classic", emoji: "üß©", tag: "PUZZLE", url: "https://zv1y2i8p.play.gamezop.com/g/rkHVpV2Yugb"},
  {name: "Fleeing the Complex", emoji: "üèÉ", tag: "HENRY", url: "https://machita66.github.io/game/fleeingthecomplex.html"},
  {name: "Escaping the Prison", emoji: "üî®", tag: "HENRY", url: "https://escaping-the-prison.com/"},
  {name: "Stealing the Diamond", emoji: "üíé", tag: "HENRY", url: "https://stealing-the-diamond.com/"},
  {name: "Infiltrating the Airship", emoji: "üéà", tag: "HENRY", url: "https://infiltrating-the-airship.com/"},
  {name: "Papa's Pizzeria", emoji: "üçï", tag: "PAPA'S", url: "https://papaspizzeria-unblocked.github.io/"},
  {name: "Papa's Pancakeria", emoji: "ü•û", tag: "PAPA'S", url: "https://papaspancakeria.github.io/"},
  {name: "Geometry Dash", emoji: "üî∑", tag: "PLATFORMER", url: "https://geometry-dash-unbanned.github.io/"},
  {name: "OvO", emoji: "ü•ö", tag: "PLATFORMER", url: "https://dedragames.com/games/ovo/1.3/"},
  {name: "Vex 5", emoji: "üî∫", tag: "PLATFORMER", url: "https://vex5.com/"},
  {name: "Vex 6", emoji: "üî∫6", tag: "PLATFORMER", url: "https://vex6.com/"},
  {name: "Big Tower Tiny Square", emoji: "üóº", tag: "PLATFORMER", url: "https://big-tower-tiny-square.com/"},
  {name: "Pac-Man", emoji: "üëª", tag: "ARCADE", url: "https://google-pacman.github.io/"},
  {name: "Chrome Dino", emoji: "ü¶ñ", tag: "ARCADE", url: "https://chrome-dino-game.github.io/"},
  {name: "Flappy Bird", emoji: "üê¶", tag: "ARCADE", url: "https://flappy-bird.com/"},
  {name: "Eaglercraft 1.8.8", emoji: "‚õèÔ∏è", tag: "MINECRAFT", url: "https://g.deev.is/eaglercraft/"},
  {name: "MineKhan", emoji: "‚õèÔ∏è", tag: "MINECRAFT", url: "https://yikuansun.github.io/minekhan/"},
  {name: "Voxel Builder", emoji: "üßä", tag: "MINECRAFT", url: "https://voxelbuilder.github.io/"}
];

// ===========================
// PROXY ENGINE SYSTEM
// ===========================
let proxyHistory = [];
let proxyHistoryPos = -1;
let currentUrl = "";

const proxyEngines = {
  translate: url => `https://translate.google.com/translate?sl=auto&tl=en&u=${encodeURIComponent(url)}`,
  croxy: url => `https://www.croxyproxy.com/?url=${encodeURIComponent(url)}`,
  proxysite: url => `https://www.proxysite.com/${url}`,
  kproxy: url => `https://kproxy.com/?q=${encodeURIComponent(url)}`,
  filterbypass: url => `https://filterbypass.me/browse.php?u=${encodeURIComponent(url)}`,
  anonymouse: url => `http://anonymouse.org/cgi-bin/anon-www.cgi/${url}`,
  unblocker: url => `https://unblocker.us/${url}`,
  textise: url => `https://r.jina.ai/http://${url.replace(/^https?:\/\//,'')}`,
  direct: url => url
};

function normalizeUrl(input) {
  if (!input.match(/^https?:\/\//i)) {
    if (input.includes('.')) return 'https://' + input;
    return 'https://www.google.com/search?q=' + encodeURIComponent(input);
  }
  return input;
}

function navigateProxy() {
  let raw = document.getElementById('proxyAddress').value.trim();
  if (!raw) return;
  
  let url = normalizeUrl(raw);
  let engine = document.getElementById('proxyEngine').value;
  let finalUrl = proxyEngines[engine](url);
  
  currentUrl = url;
  
  // Update history
  if (proxyHistoryPos < proxyHistory.length - 1) {
    proxyHistory = proxyHistory.slice(0, proxyHistoryPos + 1);
  }
  proxyHistory.push({url, engine});
  proxyHistoryPos++;
  
  document.getElementById('proxyStatus').textContent = `Loading via ${engine}...`;
  document.getElementById('proxyError').classList.remove('active');
  
  const frame = document.getElementById('proxyFrame');
  frame.src = finalUrl;
  
  // Error detection
  setTimeout(() => {
    try {
      const test = frame.contentWindow.location.href;
      document.getElementById('proxyStatus').textContent = 'Loaded';
    } catch(e) {
      if (frame.src === 'about:blank' || !frame.src) {
        showProxyError();
      } else {
        document.getElementById('proxyStatus').textContent = 'Loaded (cross-origin)';
      }
    }
  }, 5000);
}

function showProxyError() {
  document.getElementById('proxyError').classList.add('active');
  document.getElementById('proxyStatus').textContent = 'Blocked';
}

function hideProxyError() {
  document.getElementById('proxyError').classList.remove('active');
}

function openInNewTab() {
  const url = currentUrl || document.getElementById('proxyAddress').value;
  if (url) window.open(url, '_blank');
}

function tryTextMode() {
  document.getElementById('proxyEngine').value = 'textise';
  navigateProxy();
}

function proxyBack() {
  if (proxyHistoryPos > 0) {
    proxyHistoryPos--;
    loadHistory();
  }
}

function proxyForward() {
  if (proxyHistoryPos < proxyHistory.length - 1) {
    proxyHistoryPos++;
    loadHistory();
  }
}

function loadHistory() {
  let h = proxyHistory[proxyHistoryPos];
  document.getElementById('proxyAddress').value = h.url;
  document.getElementById('proxyEngine').value = h.engine;
  document.getElementById('proxyFrame').src = proxyEngines[h.engine](h.url);
}

function reloadProxy() {
  const frame = document.getElementById('proxyFrame');
  frame.src = frame.src;
}

// ===========================
// GAME FUNCTIONS
// ===========================
function init() {
  document.getElementById('gameCount').textContent = games.length;
  renderGames(games);
  loadRecentGames();
  
  const savedTitle = localStorage.getItem('cloakTitle');
  const savedIcon = localStorage.getItem('cloakIcon');
  if (savedTitle) document.title = savedTitle;
  if (savedIcon) document.getElementById('favicon').href = savedIcon;
}

function renderGames(gameList) {
  const grid = document.getElementById('gamesGrid');
  grid.innerHTML = gameList.map(game => `
    <div class="game-card" onclick="playGame('${game.name}', '${game.url}')">
      ${game.tag ? `<span class="game-tag">${game.tag}</span>` : ''}
      <span class="game-emoji">${game.emoji}</span>
      <div class="game-thumb">${game.name}</div>
      <div class="game-title">${game.name}</div>
      <div class="play-tag">CLICK TO PLAY</div>
    </div>
  `).join('');
}

function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.getElementById('nav-' + id)?.classList.add('active');
}

function playGame(name, url) {
  // Save to recent
  let recent = JSON.parse(localStorage.getItem('recentGames') || '[]');
  recent = recent.filter(g => g.name !== name);
  recent.unshift({name, url});
  recent = recent.slice(0, 8);
  localStorage.setItem('recentGames', JSON.stringify(recent));
  
  document.getElementById('gameViewer').classList.add('active');
  document.getElementById('viewerTitle').textContent = 'üéÆ ' + name;
  document.getElementById('gameFrame').src = url;
  loadRecentGames();
}

function loadRecentGames() {
  const recent = JSON.parse(localStorage.getItem('recentGames') || '[]');
  const section = document.getElementById('recentSection');
  const grid = document.getElementById('recentGrid');
  
  if (recent.length === 0) {
    section.classList.remove('active');
    return;
  }
  
  section.classList.add('active');
  grid.innerHTML = recent.map(g => `
    <div class="recent-item" onclick="playGame('${g.name}', '${g.url}')">${g.name}</div>
  `).join('');
}

function closeGame() {
  document.getElementById('gameViewer').classList.remove('active');
  document.getElementById('gameFrame').src = '';
}

function searchGames() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  const filtered = games.filter(g => g.name.toLowerCase().includes(query));
  renderGames(filtered);
}

// ===========================
// SETTINGS / TAB CLOAKING
// ===========================
function toggleSettings() {
  document.getElementById('settingsModal').classList.toggle('active');
}

function resetToLemons() {
  document.title = 'Lemons Proxy';
  document.getElementById('favicon').href = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçã</text></svg>';
  localStorage.removeItem('cloakTitle');
  localStorage.removeItem('cloakIcon');
}

function cloakTab(title, iconUrl) {
  document.title = title;
  document.getElementById('favicon').href = iconUrl;
  localStorage.setItem('cloakTitle', title);
  localStorage.setItem('cloakIcon', iconUrl);
}

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    if (document.getElementById('settingsModal').classList.contains('active')) {
      toggleSettings();
    } else if (document.getElementById('gameViewer').classList.contains('active')) {
      closeGame();
    }
  }
});

window.onload = init;
</script>
</body>
</html>
